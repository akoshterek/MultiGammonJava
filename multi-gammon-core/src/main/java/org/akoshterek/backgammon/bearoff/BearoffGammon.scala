package org.akoshterek.backgammon.bearoff

import org.akoshterek.backgammon.board.PositionId

object BearoffGammon {
  val RBG_NPROBS: Int = 5

  // race BG part
  private val y1: Array[Array[Long]] = Array(
    Array(36, 0, 0, 0, 0),
    Array(36, 0, 0, 0, 0),
    Array(6, 1080, 0, 0, 0),
    Array(6, 1080, 0, 0, 0),
    Array(0, 396, 32400, 0, 0),
    Array(0, 396, 32400, 0, 0)
  )

  private val y2: Array[Array[Long]] = Array(
    Array(36, 0, 0, 0, 0),
    Array(26, 360, 0, 0, 0),
    Array(5, 1116, 0, 0, 0),
    Array(5, 596, 18720, 0, 0),
    Array(0, 335, 33596, 36000, 0),
    Array(0, 235, 17666, 739080, 0)
  )

  private val y3: Array[Array[Long]] = Array(
    Array(36, 0, 0, 0, 0),
    Array(6, 1080, 0, 0, 0),
    Array(5, 1116, 0, 0, 0),
    Array(5, 1116, 0, 0, 0),
    Array(5, 1116, 0, 0, 0),
    Array(5, 1016, 3600, 0, 0),
    Array(0, 396, 32400, 0, 0),
    Array(0, 396, 32400, 0, 0),
    Array(0, 376, 33120, 0, 0),
    Array(0, 335, 34596, 0, 0),
    Array(0, 396, 32400, 0, 0),
    Array(0, 376, 33120, 0, 0),
    Array(0, 335, 34596, 0, 0),
    Array(0, 335, 33596, 36000, 0),
    Array(0, 335, 27296, 262800, 0)
  )

  private val y4: Array[Array[Long]] = Array(
    Array(36, 0, 0, 0, 0),
    Array(17, 684, 0, 0, 0),
    Array(4, 999, 5508, 0, 0),
    Array(4, 297, 30082, 25128, 0),
    Array(0, 272, 24281, 450484, 90144),
    Array(0, 120, 11765, 983521, 4213260)
  )

  private val y5: Array[Array[Long]] = Array(
    Array(34, 72, 0, 0, 0),
    Array(5, 1116, 0, 0, 0),
    Array(4, 1148, 144, 0, 0),
    Array(4, 1148, 144, 0, 0),
    Array(4, 1080, 2592, 0, 0),
    Array(4, 739, 14860, 288, 0),
    Array(0, 396, 32400, 0, 0),
    Array(0, 371, 33292, 288, 0),
    Array(0, 298, 35716, 7632, 0),
    Array(0, 272, 34033, 101900, 576),
    Array(0, 388, 32680, 288, 0),
    Array(0, 322, 34856, 7488, 0),
    Array(0, 272, 34794, 74504, 576),
    Array(0, 272, 27197, 346480, 55152),
    Array(0, 256, 15488, 772640, 634752)
  )

  private val y6: Array[Array[Long]] = Array(
    Array(25, 396, 0, 0, 0),
    Array(5, 1112, 144, 0, 0),
    Array(4, 1112, 1440, 0, 0),
    Array(4, 631, 18756, 0, 0),
    Array(4, 615, 19324, 288, 0),
    Array(4, 523, 22528, 4176, 0),
    Array(0, 333, 33656, 36432, 0),
    Array(0, 322, 33854, 43560, 0),
    Array(0, 297, 33393, 92540, 576),
    Array(0, 272, 30181, 240284, 10944),
    Array(0, 233, 17737, 739100, 576),
    Array(0, 217, 18281, 739964, 10944),
    Array(0, 192, 18895, 747036, 127008),
    Array(0, 192, 17551, 782404, 595584),
    Array(0, 184, 14192, 886751, 1565604)
  )

  private val y7: Array[Array[Long]] = Array(
    Array(5, 1116, 0, 0, 0),
    Array(4, 1148, 144, 0, 0),
    Array(4, 1048, 3744, 0, 0),
    Array(4, 999, 5508, 0, 0),
    Array(0, 392, 32544, 0, 0),
    Array(0, 375, 33156, 0, 0),
    Array(0, 355, 33868, 288, 0),
    Array(0, 335, 34588, 288, 0),
    Array(0, 331, 34624, 4176, 0),
    Array(0, 297, 35266, 25128, 0),
    Array(0, 371, 33292, 288, 0),
    Array(0, 331, 34732, 288, 0),
    Array(0, 298, 35716, 7632, 0),
    Array(0, 331, 33728, 36432, 0),
    Array(0, 297, 34754, 43560, 0),
    Array(0, 272, 34033, 101900, 576),
    Array(0, 330, 27470, 263016, 0),
    Array(0, 297, 28537, 267356, 576),
    Array(0, 272, 28421, 303644, 10944),
    Array(0, 272, 24281, 450484, 90144)
  )

  private val y8: Array[Array[Long]] = Array(
    Array(34, 72, 0, 0, 0),
    Array(11, 880, 720, 0, 0),
    Array(3, 751, 15482, 9000, 0),
    Array(3, 163, 30547, 225808, 104400),
    Array(0, 195, 14249, 822591, 3288276),
    Array(0, 57, 8951, 767859, 18563364)
  )

  private val y9: Array[Array[Long]] = Array(
    Array(29, 252, 0, 0, 0),
    Array(5, 1116, 0, 0, 0),
    Array(3, 1115, 2628, 0, 0),
    Array(3, 1146, 1512, 0, 0),
    Array(3, 899, 10284, 4320, 0),
    Array(3, 452, 25549, 34076, 576),
    Array(0, 392, 32544, 0, 0),
    Array(0, 333, 34408, 9360, 0),
    Array(0, 236, 35179, 106580, 26496),
    Array(0, 207, 27064, 426011, 397044),
    Array(0, 357, 33552, 9072, 0),
    Array(0, 249, 35142, 91080, 25920),
    Array(0, 207, 28985, 359990, 284184),
    Array(0, 207, 16674, 753203, 2083572),
    Array(0, 165, 8770, 941530, 7506936)
  )

  private val y10: Array[Array[Long]] = Array(
    Array(23, 468, 0, 0, 0),
    Array(5, 1086, 1080, 0, 0),
    Array(3, 1043, 5212, 288, 0),
    Array(3, 659, 19036, 288, 0),
    Array(3, 583, 21510, 9720, 0),
    Array(3, 368, 27767, 62980, 4608),
    Array(0, 325, 33734, 43992, 0),
    Array(0, 289, 33359, 103644, 18144),
    Array(0, 235, 30691, 266808, 121392),
    Array(0, 207, 23831, 532351, 758772),
    Array(0, 223, 18071, 739532, 18720),
    Array(0, 175, 19349, 750336, 212976),
    Array(0, 147, 18301, 802935, 983988),
    Array(0, 147, 13709, 895395, 3606660),
    Array(0, 129, 9184, 920983, 9389700)
  )

  private val y11: Array[Array[Long]] = Array(
    Array(5, 1112, 144, 0, 0),
    Array(3, 1144, 1584, 0, 0),
    Array(3, 1055, 4788, 0, 0),
    Array(3, 857, 11792, 4464, 0),
    Array(0, 385, 32796, 0, 0),
    Array(0, 371, 33292, 288, 0),
    Array(0, 321, 34738, 13032, 0),
    Array(0, 335, 34472, 4464, 0),
    Array(0, 308, 34657, 32780, 576),
    Array(0, 235, 34181, 143452, 39168),
    Array(0, 345, 33984, 9072, 0),
    Array(0, 309, 35268, 9504, 0),
    Array(0, 236, 35555, 93060, 25920),
    Array(0, 309, 34282, 45000, 0),
    Array(0, 235, 34783, 122124, 26784),
    Array(0, 207, 28547, 375536, 292176),
    Array(0, 307, 28169, 267628, 1152),
    Array(0, 235, 29373, 316128, 54000),
    Array(0, 207, 25276, 488623, 460260),
    Array(0, 207, 15791, 778381, 2321532)
  )

  private val y12: Array[Array[Long]] = Array(
    Array(17, 680, 144, 0, 0),
    Array(4, 983, 6076, 288, 0),
    Array(3, 923, 9488, 1872, 0),
    Array(3, 333, 29949, 29900, 576),
    Array(3, 331, 29167, 60532, 4608),
    Array(3, 283, 29081, 125244, 25920),
    Array(0, 263, 24605, 449718, 117720),
    Array(0, 245, 24912, 457129, 292860),
    Array(0, 222, 23475, 526367, 735732),
    Array(0, 207, 19394, 669443, 1573812),
    Array(0, 120, 11720, 984849, 4223772),
    Array(0, 108, 11969, 985331, 4443588),
    Array(0, 93, 12122, 963477, 5731884),
    Array(0, 93, 11334, 906514, 8803800),
    Array(0, 93, 9540, 858470, 12858408)
  )

  private val y13: Array[Array[Long]] = Array(
    Array(4, 1132, 720, 0, 0),
    Array(3, 1091, 3484, 288, 0),
    Array(3, 775, 14808, 2160, 0),
    Array(3, 715, 16754, 9864, 0),
    Array(0, 367, 33436, 288, 0),
    Array(0, 296, 35680, 11504, 576),
    Array(0, 284, 35649, 28172, 576),
    Array(0, 268, 34079, 105284, 5760),
    Array(0, 252, 33761, 136812, 29376),
    Array(0, 222, 32167, 230992, 104400),
    Array(0, 309, 35114, 15032, 576),
    Array(0, 259, 35139, 78796, 5472),
    Array(0, 223, 34893, 133328, 40752),
    Array(0, 258, 27701, 345954, 74088),
    Array(0, 222, 28523, 359568, 198288),
    Array(0, 207, 25658, 472035, 562356),
    Array(0, 246, 15840, 772067, 665748),
    Array(0, 210, 17074, 766333, 952524),
    Array(0, 195, 16968, 761467, 1964916),
    Array(0, 195, 13487, 839379, 3671460)
  )

  private val y14: Array[Array[Long]] = Array(
    Array(4, 1089, 2268, 0, 0),
    Array(3, 647, 19404, 2592, 0),
    Array(3, 559, 22396, 8928, 0),
    Array(3, 527, 23025, 27740, 576),
    Array(0, 313, 34013, 49484, 576),
    Array(0, 293, 33443, 95796, 5184),
    Array(0, 277, 32921, 134556, 32832),
    Array(0, 267, 30329, 241000, 26640),
    Array(0, 252, 30183, 263560, 103536),
    Array(0, 222, 28408, 360893, 299628),
    Array(0, 211, 18473, 740252, 31680),
    Array(0, 186, 19069, 747694, 157752),
    Array(0, 162, 19534, 758017, 303228),
    Array(0, 185, 17752, 783317, 628812),
    Array(0, 162, 18254, 788219, 874836),
    Array(0, 147, 17470, 814155, 1657044),
    Array(0, 180, 14314, 886931, 1587636),
    Array(0, 155, 15088, 882887, 1896516),
    Array(0, 141, 14977, 868919, 3196404),
    Array(0, 141, 12630, 886913, 5590332)
  )

  private val y15: Array[Array[Long]] = Array(
    Array(3, 1019, 6076, 288, 0),
    Array(0, 355, 33824, 1872, 0),
    Array(0, 331, 34492, 8928, 0),
    Array(0, 297, 35133, 29900, 576),
    Array(0, 284, 34771, 59668, 4608),
    Array(0, 285, 35948, 16112, 576),
    Array(0, 284, 35025, 50636, 576),
    Array(0, 259, 34403, 105284, 5760),
    Array(0, 222, 34305, 155740, 42624),
    Array(0, 283, 28939, 270876, 6048),
    Array(0, 258, 28885, 304624, 27504),
    Array(0, 222, 29275, 334920, 111024),
    Array(0, 258, 24785, 449718, 117720),
    Array(0, 221, 25756, 457849, 292860),
    Array(0, 207, 23447, 546031, 763956)
  )

  private val y16: Array[Array[Long]] = Array(
    Array(31, 180, 0, 0, 0),
    Array(6, 975, 3772, 288, 0),
    Array(2, 466, 25089, 78660, 18144),
    Array(2, 84, 23554, 584297, 1627164),
    Array(0, 116, 6951, 880249, 14356620),
    Array(0, 18, 6042, 425561, 36475740)
  )

  private val y17: Array[Array[Long]] = Array(
    Array(23, 468, 0, 0, 0),
    Array(4, 1148, 144, 0, 0),
    Array(2, 995, 8200, 1584, 0),
    Array(2, 1066, 5688, 0, 0),
    Array(2, 603, 22062, 10568, 576),
    Array(2, 205, 32081, 163840, 67248),
    Array(0, 383, 32860, 288, 0),
    Array(0, 254, 35419, 75284, 2304),
    Array(0, 154, 29734, 402111, 269892),
    Array(0, 140, 15913, 828583, 3482100),
    Array(0, 296, 34104, 68256, 0),
    Array(0, 164, 30562, 363296, 127584),
    Array(0, 136, 17946, 801264, 2017440),
    Array(0, 120, 7889, 1002899, 8538948),
    Array(0, 70, 5652, 775017, 21974652)
  )

  private val y18: Array[Array[Long]] = Array(
    Array(19, 608, 144, 0, 0),
    Array(4, 1065, 3132, 0, 0),
    Array(2, 884, 12012, 8208, 0),
    Array(2, 655, 20336, 5328, 0),
    Array(2, 444, 26523, 55852, 7200),
    Array(2, 189, 30326, 243663, 214596),
    Array(0, 304, 33253, 88380, 5184),
    Array(0, 224, 30938, 271784, 135360),
    Array(0, 153, 24544, 564925, 1181484),
    Array(0, 140, 14007, 849405, 5202684),
    Array(0, 193, 18775, 748820, 171648),
    Array(0, 117, 18938, 811339, 1255572),
    Array(0, 100, 13699, 913601, 5157036),
    Array(0, 92, 7775, 917424, 13070160),
    Array(0, 62, 5739, 706619, 24697476)
  )

  private val y19: Array[Array[Long]] = Array(
    Array(4, 1130, 792, 0, 0),
    Array(2, 1063, 5796, 0, 0),
    Array(2, 991, 8364, 864, 0),
    Array(2, 587, 22351, 20884, 1152),
    Array(0, 371, 33292, 288, 0),
    Array(0, 357, 33712, 3312, 0),
    Array(0, 246, 35383, 86828, 6624),
    Array(0, 327, 34262, 22392, 0),
    Array(0, 237, 34453, 131064, 39312),
    Array(0, 152, 28396, 445719, 527364),
    Array(0, 288, 34388, 68400, 0),
    Array(0, 260, 35352, 69984, 0),
    Array(0, 158, 30668, 367220, 128880),
    Array(0, 259, 34481, 102492, 5184),
    Array(0, 157, 30147, 385270, 200952),
    Array(0, 140, 17532, 803268, 2295216),
    Array(0, 257, 28879, 305844, 38016),
    Array(0, 155, 26546, 508717, 517068),
    Array(0, 140, 16334, 823115, 3133332),
    Array(0, 124, 7589, 978016, 9636912)
  )

  private val y20: Array[Array[Long]] = Array(
    Array(14, 776, 576, 0, 0),
    Array(4, 913, 8552, 1872, 0),
    Array(2, 767, 15983, 16868, 576),
    Array(2, 360, 29605, 53820, 5184),
    Array(2, 300, 28857, 156860, 64512),
    Array(2, 176, 27944, 340841, 409788),
    Array(0, 243, 24528, 474225, 268380),
    Array(0, 198, 22633, 576764, 1132416),
    Array(0, 150, 18321, 737255, 3182580),
    Array(0, 140, 12063, 859951, 7342452),
    Array(0, 108, 11969, 977637, 4720572),
    Array(0, 76, 12092, 946693, 7168140),
    Array(0, 64, 10674, 863340, 12566448),
    Array(0, 64, 7844, 761133, 19913580),
    Array(0, 52, 6032, 616407, 28031940)
  )

  private val y21: Array[Array[Long]] = Array(
    Array(4, 1099, 1908, 0, 0),
    Array(2, 1019, 7348, 1152, 0),
    Array(2, 751, 16778, 9000, 0),
    Array(2, 520, 23769, 56524, 6336),
    Array(0, 342, 34202, 5112, 0),
    Array(0, 292, 35133, 36292, 3744),
    Array(0, 225, 34874, 131282, 45720),
    Array(0, 268, 32812, 150088, 34848),
    Array(0, 220, 30222, 298601, 284508),
    Array(0, 150, 25691, 530366, 1079064),
    Array(0, 262, 35170, 73880, 2304),
    Array(0, 222, 34976, 132004, 27504),
    Array(0, 154, 30031, 392356, 236160),
    Array(0, 220, 28078, 378260, 195408),
    Array(0, 151, 25786, 529760, 931104),
    Array(0, 140, 16413, 821065, 3104748),
    Array(0, 210, 16875, 771659, 1018692),
    Array(0, 140, 17488, 793184, 2715264),
    Array(0, 132, 12957, 858233, 6618924),
    Array(0, 128, 6962, 908191, 12776580)
  )

  private val y22: Array[Array[Long]] = Array(
    Array(4, 1035, 4204, 288, 0),
    Array(2, 642, 20738, 7704, 0),
    Array(2, 555, 23523, 20180, 576),
    Array(2, 410, 27049, 80676, 18144),
    Array(0, 290, 33665, 91628, 7488),
    Array(0, 275, 33057, 132372, 28512),
    Array(0, 212, 30778, 291535, 191556),
    Array(0, 253, 29938, 271332, 94608),
    Array(0, 208, 27684, 401077, 444492),
    Array(0, 151, 23054, 608233, 1646748),
    Array(0, 184, 19038, 750756, 181008),
    Array(0, 164, 19390, 761061, 286956),
    Array(0, 113, 18750, 820147, 1368756),
    Array(0, 164, 17961, 797571, 824580),
    Array(0, 111, 17708, 838828, 2139984),
    Array(0, 100, 13209, 915715, 5715972),
    Array(0, 158, 14796, 886873, 1991484),
    Array(0, 106, 15120, 886295, 4018500),
    Array(0, 96, 12026, 896601, 8123868),
    Array(0, 92, 7533, 877093, 14835708)
  )

  private val y23: Array[Array[Long]] = Array(
    Array(2, 963, 9344, 1872, 0),
    Array(0, 331, 34550, 6840, 0),
    Array(0, 311, 34757, 25292, 576),
    Array(0, 292, 34669, 52956, 5184),
    Array(0, 225, 34049, 160400, 66672),
    Array(0, 242, 35841, 75644, 2304),
    Array(0, 242, 34959, 107252, 7488),
    Array(0, 222, 34300, 156216, 31968),
    Array(0, 153, 29610, 407273, 291420),
    Array(0, 240, 29401, 308924, 43776),
    Array(0, 220, 29234, 339556, 90576),
    Array(0, 151, 26258, 521963, 600084),
    Array(0, 220, 25312, 475809, 268380),
    Array(0, 149, 23843, 596484, 1140480),
    Array(0, 140, 15529, 836357, 3699900)
  )

  private val y24: Array[Array[Long]] = Array(
    Array(10, 887, 1764, 0, 0),
    Array(3, 719, 16407, 17156, 576),
    Array(2, 641, 19951, 37220, 4032),
    Array(2, 194, 30182, 243319, 180324),
    Array(2, 185, 28264, 318235, 388980),
    Array(2, 143, 26206, 434497, 830268),
    Array(0, 183, 14564, 820763, 3505716),
    Array(0, 160, 14565, 819849, 4610412),
    Array(0, 136, 13405, 831119, 6827796),
    Array(0, 132, 10367, 861740, 9849312),
    Array(0, 55, 8811, 772043, 18687492),
    Array(0, 47, 8633, 762062, 19650744),
    Array(0, 40, 8204, 717461, 22138956),
    Array(0, 40, 7232, 643295, 26068644),
    Array(0, 36, 6082, 562587, 30651156)
  )

  private val y25: Array[Array[Long]] = Array(
    Array(3, 1079, 3916, 288, 0),
    Array(2, 887, 11834, 10728, 0),
    Array(2, 476, 25507, 51044, 4032),
    Array(2, 402, 27073, 90180, 18144),
    Array(0, 318, 34810, 14312, 576),
    Array(0, 232, 34908, 121056, 43200),
    Array(0, 200, 34336, 181552, 99648),
    Array(0, 200, 26978, 434919, 514404),
    Array(0, 176, 26107, 485813, 930780),
    Array(0, 147, 23378, 600873, 1678428),
    Array(0, 221, 35079, 128568, 64368),
    Array(0, 182, 29423, 372592, 429264),
    Array(0, 148, 27194, 487861, 754668),
    Array(0, 176, 17571, 762085, 2047644),
    Array(0, 139, 17798, 786039, 2617380),
    Array(0, 132, 14067, 884661, 4228956),
    Array(0, 152, 9103, 939942, 7739064),
    Array(0, 113, 10135, 926300, 8712288),
    Array(0, 100, 9481, 906351, 10884564),
    Array(0, 100, 6941, 887101, 14869404)
  )

  private val y26: Array[Array[Long]] = Array(
    Array(3, 985, 7264, 1584, 0),
    Array(2, 595, 21997, 23276, 576),
    Array(2, 395, 27547, 82204, 17568),
    Array(2, 340, 27770, 144132, 65232),
    Array(0, 269, 33277, 131568, 52272),
    Array(0, 226, 30426, 285363, 216756),
    Array(0, 195, 28399, 389959, 524628),
    Array(0, 196, 23900, 538799, 950436),
    Array(0, 173, 22617, 594924, 1665792),
    Array(0, 146, 19382, 710497, 2957436),
    Array(0, 159, 19533, 759847, 378612),
    Array(0, 133, 18457, 807913, 1255788),
    Array(0, 107, 17761, 834132, 2426976),
    Array(0, 133, 14018, 894693, 3884652),
    Array(0, 105, 14160, 885933, 5322348),
    Array(0, 100, 11603, 903632, 8232336),
    Array(0, 120, 9386, 919460, 9602640),
    Array(0, 92, 9959, 897073, 10972332),
    Array(0, 88, 9081, 845101, 14167836),
    Array(0, 88, 6944, 797786, 18640728)
  )

  private val y27: Array[Array[Long]] = Array(
    Array(2, 850, 13146, 11448, 0),
    Array(0, 310, 34855, 23044, 1152),
    Array(0, 296, 34455, 55420, 7200),
    Array(0, 232, 33661, 164996, 77472),
    Array(0, 200, 32377, 248703, 221076),
    Array(0, 209, 35429, 131512, 64656),
    Array(0, 208, 34703, 158780, 70560),
    Array(0, 182, 29012, 387017, 442620),
    Array(0, 147, 26918, 497879, 798372),
    Array(0, 207, 29618, 341130, 142776),
    Array(0, 181, 25868, 495979, 641268),
    Array(0, 146, 24254, 583029, 1232172),
    Array(0, 180, 16617, 776622, 2574072),
    Array(0, 142, 16946, 792561, 3346812),
    Array(0, 136, 13415, 872781, 5315004)
  )

  private val y28: Array[Array[Long]] = Array(
    Array(3, 876, 11070, 5832, 0),
    Array(2, 355, 29081, 78820, 17568),
    Array(2, 312, 28766, 144712, 59904),
    Array(2, 268, 28254, 217343, 161604),
    Array(0, 227, 24896, 477159, 432324),
    Array(0, 209, 23554, 535275, 919188),
    Array(0, 185, 22006, 601857, 1648188),
    Array(0, 194, 19630, 671532, 1799280),
    Array(0, 172, 18904, 699721, 2751804),
    Array(0, 145, 16482, 774441, 4460508),
    Array(0, 100, 12078, 980097, 4863996),
    Array(0, 87, 12104, 965251, 5971284),
    Array(0, 71, 11891, 942537, 7811532),
    Array(0, 87, 11301, 910749, 8974044),
    Array(0, 70, 11128, 900933, 10344780),
    Array(0, 64, 10008, 845763, 14062356),
    Array(0, 87, 9602, 858987, 13039380),
    Array(0, 70, 9669, 843115, 14317092),
    Array(0, 64, 8948, 788345, 17503164),
    Array(0, 64, 7347, 721049, 22000716)
  )

  private val y29: Array[Array[Long]] = Array(
    Array(2, 711, 17893, 20684, 576),
    Array(0, 277, 35301, 49644, 5184),
    Array(0, 250, 32889, 169600, 72432),
    Array(0, 216, 31766, 251079, 180900),
    Array(0, 191, 29823, 346777, 420300),
    Array(0, 196, 34817, 169610, 92808),
    Array(0, 195, 28619, 387703, 320724),
    Array(0, 180, 26178, 483327, 741636),
    Array(0, 147, 24325, 575456, 1366128),
    Array(0, 185, 17665, 769685, 1232316),
    Array(0, 172, 17499, 767034, 2149416),
    Array(0, 137, 17091, 792659, 3388644),
    Array(0, 172, 14184, 836845, 3932460),
    Array(0, 137, 14526, 834307, 5213556),
    Array(0, 132, 11813, 863857, 7899084)
  )

  private val y30: Array[Array[Long]] = Array(
    Array(2, 537, 23595, 40820, 4032),
    Array(0, 260, 32786, 160172, 78768),
    Array(0, 239, 29984, 285233, 187740),
    Array(0, 215, 28156, 375495, 427140),
    Array(0, 191, 26442, 456345, 857628),
    Array(0, 147, 19675, 767435, 481284),
    Array(0, 147, 18377, 798257, 1053900),
    Array(0, 133, 17615, 821824, 1846224),
    Array(0, 106, 17096, 842747, 3025332),
    Array(0, 141, 15264, 885864, 2214432),
    Array(0, 128, 15090, 876847, 3371076),
    Array(0, 101, 14852, 877549, 4913964),
    Array(0, 128, 12865, 889903, 5784660),
    Array(0, 100, 13053, 881311, 7156692),
    Array(0, 96, 11075, 873594, 10184616)
  )

  private val y31: Array[Array[Long]] = Array(
    Array(0, 278, 34449, 78676, 17568),
    Array(0, 196, 34220, 190904, 99936),
    Array(0, 195, 29493, 359469, 204444),
    Array(0, 195, 25955, 480507, 432324),
    Array(0, 180, 24042, 554123, 961236),
    Array(0, 146, 22638, 628265, 1698012)
  )

  private val y: Array[Array[Array[Long]]] = Array(
    y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14, y15, y16,
    y17, y18, y19, y20, y21, y22, y23, y24, y25, y26, y27, y28, y29, y30, y31
  )

  def getRaceBGprobs(board: Array[Int]): Array[Long] = {
    require(board(5) == 0)
    var tot = 0
    var group = 0

    for (i <- 4 to 0 by -1) {
      if (board(i) != 0) {
        group += (0x1 << i)
      }
      tot += board(i)
    }

    require(group < 32)

    if (tot > 6) {
      Array.empty[Long]
    } else {
      var grpSize = 0
      val b1 = Array.ofDim[Int](6)

     for (k <- 0 until 5)  {
        if ((group & (0x1 << k)) != 0) {
          require(board(k) > 0)
          b1(grpSize) = board(k) - 1
          grpSize += 1
        }
      }

      y(group - 1)(PositionId.positionIndex(grpSize, b1))
    }
  }
}
